// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

generator erd {
  provider = "prisma-erd-generator"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Empresa {
  id       Int     @id @default(autoincrement())
  nome     String
  cnpj     Decimal @unique
  email    String
  telefone Decimal

  funcionario Funcionario[]
  pagamento   Pagamento[]

  @@map("empresas")
}

model Funcionario {
  id            Int      @id @default(autoincrement())
  nome          String
  cpf           Decimal  @unique
  email         String?
  telefone      Decimal?
  empresa_id    Int
  cargo         String
  hora_prevista Float
  salario       Float
  valor_hora    Float

  empresa Empresa @relation(fields: [empresa_id], references: [id])

  historico Historico[]
  pagamento Pagamento[]

  @@map("funcionarios")
}

model Pagamento {
  id              String   @id @default(uuid())
  funcionario_id  Int
  empresa_id      Int
  hora_trabalhada Float
  salario_bruto   Float
  valor_hora      Float
  desc_inss       Float
  desc_ir         Float
  salario_liqui   Float
  data            DateTime @default(now())

  historico Historico[]

  empresa     Empresa     @relation(fields: [empresa_id], references: [id])
  funcionario Funcionario @relation(fields: [funcionario_id], references: [id])
  empresaId   Int

  @@unique([funcionario_id, data])
  @@map("pagamentos")
}

model Historico {
  id             String       @id @default(uuid())
  funcionario    Funcionario? @relation(fields: [funcionario_id], references: [id])
  funcionario_id Int?
  pagamento      Pagamento?   @relation(fields: [pagamento_id], references: [id])
  pagamento_id   String?

  @@map("historico")
}
